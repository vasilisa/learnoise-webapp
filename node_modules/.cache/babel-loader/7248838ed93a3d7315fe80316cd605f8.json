{"ast":null,"code":"var _jsxFileName = \"/Users/vasilisaskvortsova/Documents/LEARNOISE-local/webap-learnoise-2/src/components/Board/Board.js\";\nimport React from 'react';\nimport './Board.css';\nimport Brick from '../Brick/Brick.js';\nimport ConfRate from '../Confidence/ConfRateNew.js';\nimport { API_URL } from '../../config'; // import { handleResponse } from '../helpers';\n\nimport { withRouter } from 'react-router-dom'; // import { CSSTransitionGroup } from 'react-transition-group';\n\nimport CSSTransitionGroup from 'react-transition-group/CSSTransitionGroup'; // for newer version \n\nclass Board extends React.Component {\n  constructor(props) {\n    super(props);\n    const participant_info = this.props.location.state.participant_info;\n    const block_info = this.props.location.state.block_info;\n    const pool_symbols = this.props.location.state.pool_symbols; // console.log(block_info)\n\n    const current_symbols = ['', '']; // Define intitial left and right symbols: \n\n    current_symbols[0] = pool_symbols[block_info.position[0] - 1]; // 1 if on the right symbol 1, 0 if on the left \n\n    current_symbols[1] = pool_symbols[2 - block_info.position[0]]; // \n\n    const showFeedback = this.props.location.state.participant_info.block_number === 0 ? true : false;\n    const displayConf = this.props.location.state.participant_info.block_number === 0 ? false : true; // this is to control globally whether confidence is shown after each trial or not. There is no confidence on the 1st training block \n\n    this.state = {\n      clickable: true,\n      // freezing when subject has chosen a symbol\n      animation: true,\n      // relaunch fading animation after each trial\n      feedback: Array(2).fill(null),\n      noFeedback: ['null', 'null'],\n      symbolHighlight: ['null', 'null'],\n      participant_info: participant_info,\n      block_info: block_info,\n      error: '',\n      chosen_rewards: [],\n      unchosen_rewards: [],\n      block_perf: 0.0,\n      chosen_symbols: [],\n      chosen_positions: [],\n      reaction_times: [],\n      current_symbols: current_symbols,\n      pool_symbols: pool_symbols,\n      completed: 'no',\n      showFeedback: showFeedback,\n      showConf: false,\n      confidence: [],\n      reaction_times_conf: [],\n      displayConf: displayConf\n    };\n    this.redirectToBlock.bind(this);\n    this.handleConf.bind(this);\n    this.handleClick.bind(this);\n    var time_date_first = new Date();\n    this.prev_reaction_time_date = time_date_first.getTime(); // the beginning of the trial \n  }\n\n  renderBrick(i) {\n    return /*#__PURE__*/React.createElement(Brick, {\n      symbol: this.state.current_symbols[i],\n      feedback: this.state.feedback[i],\n      animation: this.state.animation,\n      noFeedback: this.state.noFeedback[i],\n      symbolHighlight: this.state.symbolHighlight[i],\n      symbolClicked: () => this.handleClick(i),\n      showFeedback: this.state.showFeedback,\n      showConf: this.state.showConf,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 7\n      }\n    });\n  }\n\n  renderConf() {\n    if (this.state.showConf === true && this.state.displayConf === true) {\n      // adapt later && this.state.participant_info.block_number>0\n      return /*#__PURE__*/React.createElement(ConfRate, {\n        confClicked: this.handleConf.bind(this) // you have to bind here in order to have the state defined wihin the handleConf and also receives the values from the child \n        ,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }\n      });\n    } else {\n      return null;\n    }\n  } // let split handleClick in 2 parts: 1 will take care defining the choice and feedback after the click \n  // second one about displaying the feedback and passing to the next trial once confidence rating is given \n\n\n  handleConf(conf_value, rt_conf) {\n    // receives the result from the child component on the call  \n    console.log('Confidence value is:', conf_value);\n    console.log('Reaction times for confidence is:', rt_conf);\n    console.log(this.state);\n    let confidence = this.state.confidence;\n    let rt_confidence = this.state.reaction_times_conf;\n    confidence.push(conf_value);\n    rt_confidence.push(rt_conf);\n    this.setState({\n      showFeedback: true,\n      animation: true,\n      // verify\n      showConf: false,\n      confidence: confidence,\n      reaction_times_conf: rt_confidence\n    }); // update symbol without Mutation\n\n    const newcount = this.state.block_info.trial_numb + 1;\n    const end_of_block = (newcount === this.state.block_info.TotalTrial ? true : false) ? true : false; // new symbols\n\n    const current_symbols = this.state.current_symbols.slice();\n    current_symbols[0] = this.state.pool_symbols[this.state.block_info.position[newcount] - 1];\n    current_symbols[1] = this.state.pool_symbols[2 - this.state.block_info.position[newcount]]; // start new block or update reset feedbacks for next trial (without mutation)\n\n    if (end_of_block) {\n      setTimeout(() => this.redirectToBlock(), 1000);\n    } else {\n      setTimeout(() => this.setState({\n        clickable: true,\n        feedback: Array(2).fill(null),\n        noFeedback: Array(2).fill('null'),\n        symbolHighlight: Array(2).fill('null'),\n        animation: true,\n        block_info: { ...this.state.block_info,\n          trial_numb: newcount\n        },\n        current_symbols: current_symbols,\n        showFeedback: false\n      }), 1000);\n    }\n  } // second one about displaying the feedback and passing to the next trial once confidence rating is given \n\n\n  handleClick(i) {\n    console.log('Click is:', i); // 0 if the left brick clicked and 1 if the right one  \n\n    if (this.state.clickable) {\n      const feedback = this.state.feedback.slice();\n      const noFeedback = this.state.noFeedback.slice();\n      const symbolHighlight = this.state.symbolHighlight.slice(); // complete feedback \n\n      if (this.state.block_info.block_feedback === \"2\") {\n        if (this.state.block_info.position[this.state.block_info.trial_numb] === \"1\") {\n          // symbol 1 is on the left\n          feedback[i] = this.state.block_info.reward_1[this.state.block_info.trial_numb] * (i === 0) + this.state.block_info.reward_2[this.state.block_info.trial_numb] * (i === 1);\n          feedback[1 - i] = this.state.block_info.reward_2[this.state.block_info.trial_numb] * (i === 0) + this.state.block_info.reward_1[this.state.block_info.trial_numb] * (i === 1);\n        } else {\n          // symbol 1 is on the right \n          feedback[i] = this.state.block_info.reward_1[this.state.block_info.trial_numb] * (i === 1) + this.state.block_info.reward_2[this.state.block_info.trial_numb] * (i === 0);\n          feedback[1 - i] = this.state.block_info.reward_2[this.state.block_info.trial_numb] * (i === 1) + this.state.block_info.reward_1[this.state.block_info.trial_numb] * (i === 0);\n        }\n\n        noFeedback[1 - i] = '';\n        noFeedback[i] = '';\n        symbolHighlight[i] = '';\n        symbolHighlight[1 - i] = 'null';\n      } else // partial feedback \n        {\n          if (this.state.block_info.position[this.state.block_info.trial_numb] === \"1\") {\n            feedback[i] = this.state.block_info.reward_1[this.state.block_info.trial_numb] * (i === 0) + this.state.block_info.reward_2[this.state.block_info.trial_numb] * (i === 1);\n          } else {\n            feedback[i] = this.state.block_info.reward_1[this.state.block_info.trial_numb] * (i === 1) + this.state.block_info.reward_2[this.state.block_info.trial_numb] * (i === 0);\n          }\n\n          feedback[1 - i] = null; // unchosen option this will work for the partial feedback\n\n          noFeedback[1 - i] = 'null';\n          noFeedback[i] = '';\n          symbolHighlight[i] = '';\n          symbolHighlight[1 - i] = 'null';\n        }\n\n      this.setState({\n        feedback: feedback,\n        clickable: false,\n        // animation  : false,\n        noFeedback: noFeedback,\n        symbolHighlight: symbolHighlight,\n        showConf: true\n      }); // save information\n\n      let position = i === 0 ? 'left' : 'right';\n      let chosen_positions = this.state.chosen_positions;\n      chosen_positions.push(position); // chosen_symbol :  \n\n      let chosen_symbols = this.state.chosen_symbols;\n\n      if (this.state.block_info.position[this.state.block_info.trial_numb] === \"1\" & i === 0) {\n        var chosen_symbol = 1;\n      } else if (this.state.block_info.position[this.state.block_info.trial_numb] === \"2\" & i === 1) {\n        var chosen_symbol = 1;\n      } else {\n        var chosen_symbol = 2;\n      }\n\n      chosen_symbols.push(chosen_symbol); // console.log('Chosen_symbol',chosen_symbols)\n\n      const chosen_r_th = chosen_symbol === 1 ? this.state.block_info.th_reward_1[this.state.block_info.trial_numb] : this.state.block_info.th_reward_2[this.state.block_info.trial_numb];\n      const unchosen_r_th = chosen_symbol === 1 ? this.state.block_info.th_reward_2[this.state.block_info.trial_numb] : this.state.block_info.th_reward_1[this.state.block_info.trial_numb];\n      const chosen_r = chosen_symbol === 1 ? this.state.block_info.reward_1[this.state.block_info.trial_numb] : this.state.block_info.reward_2[this.state.block_info.trial_numb];\n      const unchosen_r = chosen_symbol === 1 ? this.state.block_info.reward_2[this.state.block_info.trial_numb] : this.state.block_info.reward_1[this.state.block_info.trial_numb]; // console.log('Chosen reward theoretical',chosen_r_th)\n      // console.log('Unchosen reward theoretical',unchosen_r_th)\n      // console.log('Chosen reward',chosen_r)\n      // console.log('Unchosen reward',unchosen_r)\n      // console.log('Observed chosen feedback',feedback[i])\n      // console.log('Observed unchosen feedback',feedback[1-i])\n\n      let block_perf = this.state.block_perf + (chosen_r_th - unchosen_r_th) / this.state.block_info.position.length;\n      let reaction_times = this.state.reaction_times;\n      var date = new Date();\n      let reaction_time = date.getTime() - this.prev_reaction_time_date; // choice reaction time \n\n      this.prev_reaction_time_date = date.getTime();\n      reaction_times.push(reaction_time);\n      let chosen_rewards = this.state.chosen_rewards;\n      chosen_rewards.push(feedback[i]);\n      let unchosen_rewards = this.state.unchosen_rewards;\n      unchosen_rewards.push(feedback[1 - i]);\n      this.setState({\n        chosen_positions: chosen_positions,\n        chosen_symbols: chosen_symbols,\n        chosen_rewards: chosen_rewards,\n        unchosen_rewards: unchosen_rewards,\n        reaction_times: reaction_times,\n        block_perf: block_perf\n      });\n    }\n\n    if (this.state.displayConf === false) {\n      console.log('Confidence value is not provided');\n      let confidence = this.state.confidence;\n      let rt_confidence = this.state.reaction_times_conf;\n      confidence.push(-1000); // for consistency in the DB  \n\n      rt_confidence.push(-1000);\n      this.setState({\n        confidence: confidence,\n        reaction_times_conf: rt_confidence,\n        showFeedback: true,\n        animation: false\n      }); // update symbol without Mutation\n\n      const newcount = this.state.block_info.trial_numb + 1;\n      const end_of_block = (newcount === this.state.block_info.TotalTrial ? true : false) ? true : false; // new symbols\n\n      const current_symbols = this.state.current_symbols.slice();\n      current_symbols[0] = this.state.pool_symbols[this.state.block_info.position[newcount] - 1];\n      current_symbols[1] = this.state.pool_symbols[2 - this.state.block_info.position[newcount]]; // start new block or update reset feedbacks for next trial (without mutation)\n\n      if (end_of_block) {\n        setTimeout(() => this.redirectToBlock(), 1000);\n      } else {\n        setTimeout(() => this.setState({\n          clickable: true,\n          feedback: Array(2).fill(null),\n          noFeedback: Array(2).fill('null'),\n          symbolHighlight: Array(2).fill('null'),\n          animation: true,\n          block_info: { ...this.state.block_info,\n            trial_numb: newcount\n          },\n          current_symbols: current_symbols,\n          showFeedback: false\n        }), 1000);\n      }\n    }\n  }\n\n  redirectToBlock() // Compute the block relative performance: \n  {\n    let block_id = this.state.block_info.block_number;\n    let body = {\n      'block_number': this.state.participant_info.block_number + 1,\n      'chosen_positions': this.state.chosen_positions,\n      'chosen_symbols': this.state.chosen_symbols,\n      'chosen_rewards': this.state.chosen_rewards,\n      'unchosen_rewards': this.state.unchosen_rewards,\n      'reaction_times': this.state.reaction_times,\n      'block_perf': this.state.block_perf,\n      'completed': 'yes',\n      'date': this.state.participant_info.date,\n      'date_time': this.state.participant_info.date_time,\n      'game_id': this.state.participant_info.game_id,\n      'confidence': this.state.confidence,\n      'reaction_times_conf': this.state.reaction_times_conf\n    };\n    fetch(`${API_URL}/participants_data/create/` + this.state.participant_info.participant_id + `/` + block_id + `/` + this.state.participant_info.prolific_id, {\n      method: 'POST',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(body)\n    });\n    this.props.history.push({\n      pathname: `/Block`,\n      state: {\n        participant_info: this.state.participant_info,\n        newblock_frame: false\n      }\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"allBricks\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"brick1\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 9\n      }\n    }, \" \", this.renderBrick(0), \" \"), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"brick2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 9\n      }\n    }, \" \", this.renderBrick(1), \" \")), /*#__PURE__*/React.createElement(\"center\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"conf\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }\n    }, \" \", this.renderConf())));\n  }\n\n}\n\nexport default withRouter(Board);","map":{"version":3,"sources":["/Users/vasilisaskvortsova/Documents/LEARNOISE-local/webap-learnoise-2/src/components/Board/Board.js"],"names":["React","Brick","ConfRate","API_URL","withRouter","CSSTransitionGroup","Board","Component","constructor","props","participant_info","location","state","block_info","pool_symbols","current_symbols","position","showFeedback","block_number","displayConf","clickable","animation","feedback","Array","fill","noFeedback","symbolHighlight","error","chosen_rewards","unchosen_rewards","block_perf","chosen_symbols","chosen_positions","reaction_times","completed","showConf","confidence","reaction_times_conf","redirectToBlock","bind","handleConf","handleClick","time_date_first","Date","prev_reaction_time_date","getTime","renderBrick","i","renderConf","conf_value","rt_conf","console","log","rt_confidence","push","setState","newcount","trial_numb","end_of_block","TotalTrial","slice","setTimeout","block_feedback","reward_1","reward_2","chosen_symbol","chosen_r_th","th_reward_1","th_reward_2","unchosen_r_th","chosen_r","unchosen_r","length","date","reaction_time","block_id","body","date_time","game_id","fetch","participant_id","prolific_id","method","headers","JSON","stringify","history","pathname","newblock_frame","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Board.css';\nimport Brick from '../Brick/Brick.js'\nimport ConfRate from '../Confidence/ConfRateNew.js'\n\nimport { API_URL } from '../../config';\n// import { handleResponse } from '../helpers';\nimport {withRouter} from 'react-router-dom';\n\n// import { CSSTransitionGroup } from 'react-transition-group';\nimport CSSTransitionGroup from 'react-transition-group/CSSTransitionGroup'; // for newer version \n\nclass Board extends React.Component {\n  constructor(props){\n    super(props);\n\n    const participant_info = this.props.location.state.participant_info\n    const block_info       = this.props.location.state.block_info\n    const pool_symbols     = this.props.location.state.pool_symbols\n\n    // console.log(block_info)\n    const current_symbols  = ['','']\n\n    \n    // Define intitial left and right symbols: \n    current_symbols[0]    = pool_symbols[block_info.position[0]-1] // 1 if on the right symbol 1, 0 if on the left \n    current_symbols[1]    = pool_symbols[2-block_info.position[0]] // \n\n    const showFeedback    = (this.props.location.state.participant_info.block_number===0) ? true : false\n    const displayConf     = (this.props.location.state.participant_info.block_number===0) ? false : true // this is to control globally whether confidence is shown after each trial or not. There is no confidence on the 1st training block \n     \n    this.state = {\n      clickable        : true, // freezing when subject has chosen a symbol\n      animation        : true, // relaunch fading animation after each trial\n      feedback         : Array(2).fill(null),\n      noFeedback       : ['null', 'null'],\n      symbolHighlight  : ['null', 'null'],\n      participant_info : participant_info,\n      block_info       : block_info,        \n      error            : '',\n      chosen_rewards   : [],\n      unchosen_rewards : [],\n      block_perf       : 0.0,\n      chosen_symbols   : [],\n      chosen_positions : [],\n      reaction_times   : [],\n      current_symbols  : current_symbols,\n      pool_symbols     : pool_symbols,  \n      completed        : 'no', \n      showFeedback     : showFeedback,\n      showConf         : false, \n      confidence       : [], \n      reaction_times_conf: [], \n      displayConf      :  displayConf  \n    };\n\n    this.redirectToBlock.bind(this)\n    this.handleConf.bind(this)\n    this.handleClick.bind(this)\n    \n    var time_date_first          = new Date()\n    this.prev_reaction_time_date = time_date_first.getTime() // the beginning of the trial \n  };  \n\n\n  renderBrick(i) {\n    return (\n      <Brick\n        symbol          = {this.state.current_symbols[i]}\n        feedback        = {this.state.feedback[i]}\n        animation       = {this.state.animation}\n        noFeedback      = {this.state.noFeedback[i]}\n        symbolHighlight = {this.state.symbolHighlight[i]}\n        symbolClicked   = {() => this.handleClick(i)}\n        showFeedback    = {this.state.showFeedback}\n        showConf        = {this.state.showConf}\n        \n      />\n    );\n  }\n\n\n  renderConf() {\n\n    if (this.state.showConf === true && this.state.displayConf===true) { // adapt later && this.state.participant_info.block_number>0\n        return(\n          <ConfRate\n            confClicked = {this.handleConf.bind(this)} // you have to bind here in order to have the state defined wihin the handleConf and also receives the values from the child \n          />)\n        ;}\n    else {\n      return(null);}\n   }\n\n// let split handleClick in 2 parts: 1 will take care defining the choice and feedback after the click \n// second one about displaying the feedback and passing to the next trial once confidence rating is given \n  handleConf(conf_value,rt_conf){ // receives the result from the child component on the call  \n\n    console.log('Confidence value is:',conf_value) \n    console.log('Reaction times for confidence is:',rt_conf) \n    \n    console.log(this.state) \n\n    let confidence     = this.state.confidence; \n    let rt_confidence  = this.state.reaction_times_conf; \n\n    confidence.push(conf_value)\n    rt_confidence.push(rt_conf)\n\n\n    this.setState({\n      showFeedback: true, \n      animation: true, // verify\n      showConf: false,\n      confidence: confidence, \n      reaction_times_conf: rt_confidence  \n    })\n\n\n    // update symbol without Mutation\n    const newcount     = this.state.block_info.trial_numb + 1\n    const end_of_block = (newcount === this.state.block_info.TotalTrial ? true : false ) ? true : false \n    \n    // new symbols\n    const current_symbols = this.state.current_symbols.slice();\n    current_symbols[0]    = this.state.pool_symbols[this.state.block_info.position[newcount] - 1]\n    current_symbols[1]    = this.state.pool_symbols[2-this.state.block_info.position[newcount]]\n\n\n      // start new block or update reset feedbacks for next trial (without mutation)\n      if (end_of_block){\n        setTimeout(() => this.redirectToBlock()\n                , 1000);        \n      }\n      else {\n        setTimeout(() => this.setState({\n          clickable  : true,\n          feedback   : Array(2).fill(null),\n          noFeedback : Array(2).fill('null'),\n          symbolHighlight: Array(2).fill('null'),\n          animation  : true,\n          block_info : {...this.state.block_info, trial_numb:newcount},\n          current_symbols : current_symbols,\n          showFeedback: false         \n        }), 1000);     \n      }\n    }\n  \n// second one about displaying the feedback and passing to the next trial once confidence rating is given \n  handleClick(i) {\n\n    console.log('Click is:',i) // 0 if the left brick clicked and 1 if the right one  \n    \n    if (this.state.clickable) {\n\n      const feedback        = this.state.feedback.slice();\n      const noFeedback      = this.state.noFeedback.slice();\n      const symbolHighlight = this.state.symbolHighlight.slice();\n      \n    // complete feedback \n    if (this.state.block_info.block_feedback===\"2\") {\n        if (this.state.block_info.position[this.state.block_info.trial_numb] === \"1\") {\n         // symbol 1 is on the left\n          feedback[i]   = this.state.block_info.reward_1[this.state.block_info.trial_numb]*(i===0) + this.state.block_info.reward_2[this.state.block_info.trial_numb]*(i===1)\n          feedback[1-i] = this.state.block_info.reward_2[this.state.block_info.trial_numb]*(i===0) + this.state.block_info.reward_1[this.state.block_info.trial_numb]*(i===1)\n        }\n        else {\n\n          // symbol 1 is on the right \n          feedback[i]   = this.state.block_info.reward_1[this.state.block_info.trial_numb]*(i===1) + this.state.block_info.reward_2[this.state.block_info.trial_numb]*(i===0)\n          feedback[1-i] = this.state.block_info.reward_2[this.state.block_info.trial_numb]*(i===1) + this.state.block_info.reward_1[this.state.block_info.trial_numb]*(i===0)\n       \n        }\n\n        noFeedback[1 - i]    = ''\n        noFeedback[i]        = ''\n        symbolHighlight[i]   = ''\n        symbolHighlight[1-i] = 'null'\n\n      }\n    else  // partial feedback \n      {\n        if (this.state.block_info.position[this.state.block_info.trial_numb] === \"1\") {\n\n          feedback[i]   = this.state.block_info.reward_1[this.state.block_info.trial_numb]*(i===0) + this.state.block_info.reward_2[this.state.block_info.trial_numb]*(i===1)\n       \n        }\n        else {\n          feedback[i]   = this.state.block_info.reward_1[this.state.block_info.trial_numb]*(i===1) + this.state.block_info.reward_2[this.state.block_info.trial_numb]*(i===0)\n          \n        }\n\n      feedback[1 - i]      = null // unchosen option this will work for the partial feedback\n      noFeedback[1 - i]    = 'null'\n      noFeedback[i]        = ''\n      symbolHighlight[i]   = ''\n      symbolHighlight[1-i] = 'null'\n    \n    }\n  \n      this.setState({        \n        feedback   : feedback,\n        clickable  : false,\n        // animation  : false,\n        noFeedback : noFeedback,\n        symbolHighlight: symbolHighlight, \n        showConf: true, \n      })\n\n    \n      // save information\n      let position         = (i === 0) ? 'left' : 'right'; \n      let chosen_positions = this.state.chosen_positions;\n      chosen_positions.push(position)\n\n      // chosen_symbol :  \n      let chosen_symbols = this.state.chosen_symbols;\n      if (this.state.block_info.position[this.state.block_info.trial_numb] === \"1\" & (i === 0)) {\n          var chosen_symbol = 1\n        }\n      else if (this.state.block_info.position[this.state.block_info.trial_numb] === \"2\" & (i === 1)) {\n          var chosen_symbol = 1\n        }\n      else {\n        var chosen_symbol = 2\n      }\n\n      chosen_symbols.push(chosen_symbol)  \n      // console.log('Chosen_symbol',chosen_symbols)\n\n      const chosen_r_th   = chosen_symbol===1 ? this.state.block_info.th_reward_1[this.state.block_info.trial_numb] : this.state.block_info.th_reward_2[this.state.block_info.trial_numb];\n      const unchosen_r_th = chosen_symbol===1 ? this.state.block_info.th_reward_2[this.state.block_info.trial_numb] : this.state.block_info.th_reward_1[this.state.block_info.trial_numb];\n      \n      \n      const chosen_r   = chosen_symbol===1 ? this.state.block_info.reward_1[this.state.block_info.trial_numb] : this.state.block_info.reward_2[this.state.block_info.trial_numb];\n      const unchosen_r = chosen_symbol===1 ? this.state.block_info.reward_2[this.state.block_info.trial_numb] : this.state.block_info.reward_1[this.state.block_info.trial_numb];\n      \n      // console.log('Chosen reward theoretical',chosen_r_th)\n      // console.log('Unchosen reward theoretical',unchosen_r_th)\n\n      // console.log('Chosen reward',chosen_r)\n      // console.log('Unchosen reward',unchosen_r)\n\n      // console.log('Observed chosen feedback',feedback[i])\n      // console.log('Observed unchosen feedback',feedback[1-i])\n      \n      let block_perf = this.state.block_perf + ((chosen_r_th-unchosen_r_th)/this.state.block_info.position.length) \n\n      let reaction_times           = this.state.reaction_times;\n      var date                     = new Date()\n      let reaction_time            = date.getTime() - this.prev_reaction_time_date // choice reaction time \n      this.prev_reaction_time_date = date.getTime()\n      reaction_times.push(reaction_time)\n\n      let chosen_rewards   = this.state.chosen_rewards; \n      chosen_rewards.push(feedback[i])\n\n      let unchosen_rewards = this.state.unchosen_rewards; \n      unchosen_rewards.push(feedback[1-i])\n\n      this.setState({        \n        chosen_positions : chosen_positions,\n        chosen_symbols   : chosen_symbols,\n        chosen_rewards   : chosen_rewards,\n        unchosen_rewards : unchosen_rewards, \n        reaction_times   : reaction_times,\n        block_perf       : block_perf, \n\n      }) \n   }\n  \n   if (this.state.displayConf===false) {\n\n    console.log('Confidence value is not provided') \n    \n    let confidence     = this.state.confidence; \n    let rt_confidence  = this.state.reaction_times_conf; \n\n    confidence.push(-1000) // for consistency in the DB  \n    rt_confidence.push(-1000)\n\n\n      this.setState({        \n        confidence : confidence, \n        reaction_times_conf : rt_confidence,\n        showFeedback: true, \n        animation: false\n      }) \n\n      // update symbol without Mutation\n      const newcount     = this.state.block_info.trial_numb + 1\n      const end_of_block = (newcount === this.state.block_info.TotalTrial ? true : false ) ? true : false \n    \n      // new symbols\n      const current_symbols = this.state.current_symbols.slice();\n      current_symbols[0]    = this.state.pool_symbols[this.state.block_info.position[newcount] - 1]\n      current_symbols[1]    = this.state.pool_symbols[2-this.state.block_info.position[newcount]]\n\n\n      // start new block or update reset feedbacks for next trial (without mutation)\n      if (end_of_block){\n        setTimeout(() => this.redirectToBlock()\n                , 1000);        \n      }\n      else {\n        setTimeout(() => this.setState({\n          clickable  : true,\n          feedback   : Array(2).fill(null),\n          noFeedback : Array(2).fill('null'),\n          symbolHighlight: Array(2).fill('null'),\n          animation  : true,\n          block_info : {...this.state.block_info, trial_numb:newcount},\n          current_symbols : current_symbols,\n          showFeedback: false         \n        }), 1000);     \n      }\n  \n   }\n  }\n\n\n\n\n  redirectToBlock ()\n\n  // Compute the block relative performance: \n\n  {\n    let block_id   = this.state.block_info.block_number\n\n    let body     = {        'block_number'     : this.state.participant_info.block_number+1, \n                            'chosen_positions' : this.state.chosen_positions,\n                            'chosen_symbols'   : this.state.chosen_symbols,\n                            'chosen_rewards'   : this.state.chosen_rewards,\n                            'unchosen_rewards' : this.state.unchosen_rewards,\n                            'reaction_times'   : this.state.reaction_times,\n                            'block_perf'       : this.state.block_perf,\n                            'completed'        :'yes',\n                            'date'             : this.state.participant_info.date,\n                            'date_time'        : this.state.participant_info.date_time, \n                            'game_id'          : this.state.participant_info.game_id, \n                            'confidence'       : this.state.confidence, \n                            'reaction_times_conf': this.state.reaction_times_conf\n                          }  \n\n    \n    fetch(`${API_URL}/participants_data/create/` + this.state.participant_info.participant_id + `/` + block_id + `/` + this.state.participant_info.prolific_id, {\n       method: 'POST',\n       headers: {\n         'Accept': 'application/json',\n         'Content-Type': 'application/json',\n       },\n       body: JSON.stringify(body)\n     })\n\n    this.props.history.push({\n      pathname: `/Block`,\n      state: {participant_info:this.state.participant_info, newblock_frame : false}\n    })    \n  }\n\n  render() {\n\n    return (\n      <div>\n        <div  className=\"allBricks\">\n        <span className='brick1'> {this.renderBrick(0)} </span>\n        <span className='brick2'> {this.renderBrick(1)} </span>\n        </div>\n      \n        <center>\n        <div className='conf'> {this.renderConf()}</div>\n        </center>\n      \n      </div>\n          );\n  }\n}\n\nexport default withRouter(Board);\n\n\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}