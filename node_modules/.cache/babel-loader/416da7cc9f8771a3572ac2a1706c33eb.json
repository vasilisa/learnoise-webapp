{"ast":null,"code":"import _objectSpread from \"/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _defineProperty from \"/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/src/components/Survey/Survey.js\";\nimport React from 'react';\nimport { Button } from 'react-bootstrap';\nimport { withRouter } from 'react-router-dom'; // import other questionnaires the same way \n\nimport * as demo from '../../questionnaires/DEMO';\nimport * as ybocs from '../../questionnaires/YBOCS';\nimport * as covid from '../../questionnaires/COVID19';\nimport * as pad from '../../questionnaires/PAD-WSUR';\nimport * as hads from '../../questionnaires/HADS';\nimport * as pss from '../../questionnaires/PSS';\nimport * as pswq from '../../questionnaires/PSWQ';\nimport * as ius from '../../questionnaires/IUS';\nimport * as bis from '../../questionnaires/BIS11';\nimport * as feedback from '../../questionnaires/FEEDBACK';\n\nvar quizData = _defineProperty({\n  feedback: feedback,\n  pad: pad,\n  hads: hads,\n  pss: pss,\n  pswq: pswq,\n  bis: bis,\n  ius: ius,\n  demo: demo,\n  ybocs: ybocs,\n  covid: covid\n}, \"feedback\", feedback);\n\nfunction createQuiz(id, survey_name) {\n  return {\n    id: id,\n    surveytag: survey_name,\n    quizQuestions: quizData[survey_name]\n  };\n} // var list = [];\n//  for(var i = 0; i < n; i++) {\n//     var obj = createQuiz(i,survey_list[i]); //add other params if you need\n//     list.push(obj);\n//  }\n//  console.log(list);\n\n\nvar Survey =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Survey, _React$Component);\n\n  function Survey(props) {\n    var _this;\n\n    _classCallCheck(this, Survey);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Survey).call(this, props));\n    var survey_list = _this.props.location.state.participant_info.survey_list; // Information about a specific block of the Survey: \n\n    var block_info = {\n      surveytag: survey_list[0] // First questionnaire in the list \n\n    };\n    _this.state = {\n      participant_info: _this.props.location.state.participant_info,\n      block_info: block_info,\n      newblock_frame: _this.props.location.state.newblock_frame,\n      questions: quizData[survey_list[0]].default,\n      finished: false,\n      survey_list: survey_list // block_number : 0, // 0 by default -> might move it within Survey component \n      // TotalBlock: 2, // should equal n - the number of questionnaires for right now -> might move it within Survey component\n\n    };\n\n    _this.getSurveyBlock.bind(_assertThisInitialized(_this));\n\n    _this.redirectToQuiz.bind(_assertThisInitialized(_this));\n\n    _this.redirectToEnd.bind(_assertThisInitialized(_this)); // TO BE CHANGED \n\n\n    _this._isMounted = false;\n\n    _this._handleGoBack.bind(_assertThisInitialized(_this));\n\n    _this._handleTimeOut.bind(_assertThisInitialized(_this));\n\n    return _this;\n  }\n\n  _createClass(Survey, [{\n    key: \"redirectToQuiz\",\n    value: function redirectToQuiz() {\n      if (this.props.location.state.participant_info.block_number <= this.props.location.state.participant_info.TotalBlock) {\n        if (this.state.newblock_frame) {\n          // TRUE\n          this.setState({\n            newblock_frame: false\n          });\n          console.log(this.state.newblock_frame);\n          this.props.history.push({\n            pathname: \"/QuizBlock\",\n            state: {\n              participant_info: this.state.participant_info,\n              block_info: this.state.block_info,\n              questions: this.state.questions // block_number    : this.state.block_number, \n              // TotalBlock      : this.state.TotalBlock \n\n            }\n          });\n        } else // FALSE \n          {\n            if (this._isMounted) {\n              console.log('Block number', this.props.location.state.participant_info.block_number);\n\n              if (this.props.location.state.participant_info.block_number === this.props.location.state.participant_info.TotalBlock) {\n                // just finished the LAST BLOCK \n                // redirect to the final \n                this.setState({\n                  finished: true\n                });\n              } else if (this.props.location.state.participant_info.block_number < this.props.location.state.participant_info.TotalBlock) {\n                // just finished the LAST BLOCK \n                var newblocknumber = this.props.location.state.participant_info.block_number + 1;\n                console.log(newblocknumber);\n                this.getSurveyBlock(newblocknumber, survey_list);\n                this.setState({\n                  newblock_frame: true,\n                  participant_info: _objectSpread({}, this.state.participant_info, {\n                    block_number: newblocknumber\n                  })\n                });\n              }\n            }\n          }\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this._isMounted = true;\n      document.body.style.background = '#fff';\n      this._isMounted && this.getSurveyBlock(this.props.location.state.participant_info.block_number, survey_list);\n      window.history.pushState(window.state, null, window.location.href);\n      window.addEventListener('popstate', function (e) {\n        return _this2._handleGoBack(e);\n      });\n      window.onbeforeunload = this._handleRefresh;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      clearTimeout(this._handleTimeOut);\n    }\n  }, {\n    key: \"_handleRefresh\",\n    value: function _handleRefresh(evt) {\n      return false; // error message when refresh occurs\n    }\n  }, {\n    key: \"_handleGoBack\",\n    value: function _handleGoBack(event) {\n      window.history.go(1);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n    }\n  }, {\n    key: \"_handleTimeOut\",\n    value: function _handleTimeOut() {\n      var _this3 = this;\n\n      setTimeout(function () {\n        _this3.redirectToQuiz();\n      }, 1500);\n    } // Get info about the specific Survey Block: \n\n  }, {\n    key: \"getSurveyBlock\",\n    value: function getSurveyBlock(block_number_, survey_list) {\n      console.log('Block Number Get Survey Block:', block_number_ + 1);\n      var surveytag_block = survey_list[block_number_];\n      console.log('SurveyTag Block:', surveytag_block);\n      this.setState({\n        loading: true,\n        questions: quizData[survey_list[block_number_]].default,\n        block_info: _objectSpread({}, this.state.block_info, {\n          surveytag: surveytag_block\n        })\n      });\n    }\n  }, {\n    key: \"redirectToEnd\",\n    value: function redirectToEnd() {\n      alert(\"You will be redirected to the validation page. Please, confirm leaving the page. Thank you!\"); // window.location.replace('https://app.prolific.co/submissions/complete?cc=1A496EDB')\n\n      window.location = 'https://app.prolific.co/submissions/complete?cc=XXXXXXXX'; // add STUDY_ID \n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var text;\n\n      if (this.state.block_info.surveytag === survey_list[0] && this.state.newblock_frame) {\n        text = React.createElement(\"div\", {\n          className: \"SurveyIntroText\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        }, \" \", React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        }, \"Dear Participant,\"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182\n          },\n          __self: this\n        }, \"Thank you for taking part in our study!\"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183\n          },\n          __self: this\n        }, \"The current study investigating \\u2018decision-making in time of uncertainty\\u2019 will take about X minutes.\"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184\n          },\n          __self: this\n        }, \"You will be asked to complete several questionnaires and play a decision-making task.\"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 185\n          },\n          __self: this\n        }, \"Please do not start until you will have enough time to complete it in one go.\"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186\n          },\n          __self: this\n        }, \"Please close other programs (e.g. chat or e-mail) to avoid distractions.\"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"bold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188\n          },\n          __self: this\n        }, \"Good luck!\")));\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191\n          },\n          __self: this\n        }, React.createElement(\"center\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"instructionsButtonContainer\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 194\n          },\n          __self: this\n        }, text), React.createElement(\"center\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, React.createElement(Button, {\n          className: \"buttonInstructionStart\",\n          onClick: function onClick() {\n            return _this4.redirectToQuiz();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"bold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199\n          },\n          __self: this\n        }, \"START\"))))));\n      } else if (this.state.block_info.surveytag !== survey_list[0] && this.state.newblock_frame) {\n        console.log(this.state.block_number);\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 210\n          },\n          __self: this\n        }, this._handleTimeOut());\n      } else if (this.props.location.state.participant_info.block_number === this.props.location.state.participant_info.TotalBlock && this.state.finished === true) {\n        text = React.createElement(\"div\", {\n          className: \"SurveyIntroText\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }, \" \", React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"bold\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }, \"You finished the survey!\"), \" \"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216\n          },\n          __self: this\n        }, \"Thank you for your participation!\"), React.createElement(Button, {\n          variant: \"secondary\",\n          color: \"danger\",\n          size: \"sm\",\n          className: \"buttonInstructionFinal\",\n          type: \"submit\",\n          onClick: function onClick() {\n            return _this4.redirectToEnd();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        }, \"Click here \"));\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219\n          },\n          __self: this\n        }, React.createElement(\"center\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"restarttraining\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }, text, \"  \", React.createElement(\"div\", {\n          className: \"translate\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }))));\n      } else {\n        text = '... CONTINUE ...';\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232\n          },\n          __self: this\n        }, React.createElement(\"center\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 233\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"SurveyIntroText\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 234\n          },\n          __self: this\n        }, text), React.createElement(\"center\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 237\n          },\n          __self: this\n        }, React.createElement(Button, {\n          className: \"buttonInstructionStart\",\n          onClick: function onClick() {\n            return _this4.redirectToQuiz();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 238\n          },\n          __self: this\n        }, \"\\u2192\"))));\n      }\n    }\n  }]);\n\n  return Survey;\n}(React.Component);\n\nexport default withRouter(Survey);","map":{"version":3,"sources":["/Users/vasilisaskvortsova/Documents/COVID-19/covid-webap/src/components/Survey/Survey.js"],"names":["React","Button","withRouter","demo","ybocs","covid","pad","hads","pss","pswq","ius","bis","feedback","quizData","createQuiz","id","survey_name","surveytag","quizQuestions","Survey","props","survey_list","location","state","participant_info","block_info","newblock_frame","questions","default","finished","getSurveyBlock","bind","redirectToQuiz","redirectToEnd","_isMounted","_handleGoBack","_handleTimeOut","block_number","TotalBlock","setState","console","log","history","push","pathname","newblocknumber","document","body","style","background","window","pushState","href","addEventListener","e","onbeforeunload","_handleRefresh","clearTimeout","evt","event","go","setTimeout","block_number_","surveytag_block","loading","alert","text","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Button } from 'react-bootstrap';\nimport {withRouter} from 'react-router-dom';\n\n// import other questionnaires the same way \nimport * as demo  from '../../questionnaires/DEMO'; \nimport * as ybocs from '../../questionnaires/YBOCS'; \nimport * as covid from '../../questionnaires/COVID19';\nimport * as pad from '../../questionnaires/PAD-WSUR';\nimport * as hads from '../../questionnaires/HADS';\nimport * as pss from '../../questionnaires/PSS';\nimport * as pswq from '../../questionnaires/PSWQ';\nimport * as ius from '../../questionnaires/IUS';\nimport * as bis from '../../questionnaires/BIS11';\nimport * as feedback from '../../questionnaires/FEEDBACK';\n\n\n\nvar quizData = {\n  feedback:feedback,\n  pad:pad,\n  hads: hads, \n  pss: pss,\n  pswq: pswq,\n  bis: bis,\n  ius: ius,  \n  demo:demo,\n  ybocs:ybocs,\n  covid:covid, \n  feedback: feedback \n}\n\n\nfunction createQuiz(id,survey_name) {\n     return {\n         id: id,\n         surveytag: survey_name,\n         quizQuestions: quizData[survey_name]\n     };\n }\n\n\n// var list = [];\n//  for(var i = 0; i < n; i++) {\n//     var obj = createQuiz(i,survey_list[i]); //add other params if you need\n//     list.push(obj);\n//  }\n//  console.log(list);\n\n\nclass Survey extends React.Component {\n  constructor(props){\n    super(props);\n\n    const survey_list = this.props.location.state.participant_info.survey_list\n    // Information about a specific block of the Survey: \n    const block_info = {\n      surveytag  : survey_list[0], // First questionnaire in the list \n     }\n\n    this.state = {\n      participant_info : this.props.location.state.participant_info,\n      block_info       : block_info,\n      newblock_frame   : this.props.location.state.newblock_frame,  \n      questions        : quizData[survey_list[0]].default,\n      finished         : false, \n      survey_list      : survey_list\n      // block_number : 0, // 0 by default -> might move it within Survey component \n      // TotalBlock: 2, // should equal n - the number of questionnaires for right now -> might move it within Survey component\n   \n    }\n\n   \n    this.getSurveyBlock.bind(this);\n    this.redirectToQuiz.bind(this); \n    this.redirectToEnd.bind(this); // TO BE CHANGED \n    this._isMounted = false;\n    this._handleGoBack.bind(this); \n    this._handleTimeOut.bind(this);   \n  }\n\n\n  redirectToQuiz () {\n      if((this.props.location.state.participant_info.block_number <= (this.props.location.state.participant_info.TotalBlock)))\n          {           \n          if (this.state.newblock_frame){ // TRUE\n          this.setState({newblock_frame : false})\n\n          console.log(this.state.newblock_frame)\n          this.props.history.push({\n           pathname: `/QuizBlock`,\n           state: {participant_info: this.state.participant_info,\n                   block_info      : this.state.block_info,\n                   questions       : this.state.questions,\n                   // block_number    : this.state.block_number, \n                   // TotalBlock      : this.state.TotalBlock \n                 }\n          })}\n          else // FALSE \n          {\n            if (this._isMounted)\n            {\n\n              console.log('Block number',this.props.location.state.participant_info.block_number)\n              \n              if (this.props.location.state.participant_info.block_number===this.props.location.state.participant_info.TotalBlock){ // just finished the LAST BLOCK \n              \n                // redirect to the final \n                this.setState({finished: true})\n\n              } \n              else if (this.props.location.state.participant_info.block_number<this.props.location.state.participant_info.TotalBlock){ // just finished the LAST BLOCK \n              \n              const newblocknumber = this.props.location.state.participant_info.block_number + 1\n              console.log(newblocknumber)\n              this.getSurveyBlock(newblocknumber,survey_list)\n              this.setState({newblock_frame: true, participant_info : {...this.state.participant_info, block_number:newblocknumber},}) \n              }\n\n            }\n          }\n        }\n      }\n    \n  componentDidMount() { \n  this._isMounted = true;\n  document.body.style.background= '#fff'; \n  this._isMounted && this.getSurveyBlock(this.props.location.state.participant_info.block_number,survey_list);\n    window.history.pushState(window.state, null, window.location.href);\n    window.addEventListener('popstate', e => this._handleGoBack(e));\n    window.onbeforeunload = this._handleRefresh\n\n  }\n\n  componentWillUnmount() {\n    clearTimeout(this._handleTimeOut);\n  }\n\n  _handleRefresh(evt){\n    return false // error message when refresh occurs\n  }\n\n  _handleGoBack(event){\n    window.history.go(1);\n  }\n\n  componentWillUnmount()\n  {\n   this._isMounted = false;\n  } \n\n  _handleTimeOut() {\n    setTimeout(() => {\n     this.redirectToQuiz()\n    }, 1500);\n} \n\n // Get info about the specific Survey Block: \n getSurveyBlock(block_number_,survey_list) {\n\n    console.log('Block Number Get Survey Block:',block_number_+1)\n\n    const surveytag_block = survey_list[block_number_]\n    console.log('SurveyTag Block:',surveytag_block)\n \n    this.setState({ loading: true , questions: quizData[survey_list[block_number_]].default, block_info : {...this.state.block_info, surveytag:surveytag_block}});\n\n}\n\n redirectToEnd(){\n    alert(\"You will be redirected to the validation page. Please, confirm leaving the page. Thank you!\")\n    // window.location.replace('https://app.prolific.co/submissions/complete?cc=1A496EDB')\n    window.location = 'https://app.prolific.co/submissions/complete?cc=XXXXXXXX' // add STUDY_ID \n}\n\nrender()\n  { \n    let text\n    if ((this.state.block_info.surveytag === survey_list[0]) && (this.state.newblock_frame))\n    { \n      text = <div className='SurveyIntroText'> <p>Dear Participant,</p>\n      <p>Thank you for taking part in our study!</p>\n      <p>The current study investigating ‘decision-making in time of uncertainty’ will take about X minutes.</p> \n      <p>You will be asked to complete several questionnaires and play a decision-making task.</p>\n      <p>Please do not start until you will have enough time to complete it in one go.</p>\n      <p>Please close other programs (e.g. chat or e-mail) to avoid distractions.</p>\n\n      <p><span className=\"bold\">Good luck!</span></p></div>\n\n    return (\n      <div>\n      <center> \n      <div className=\"instructionsButtonContainer\">\n        <div>\n          {text}           \n        </div> \n        <center>\n          <Button className=\"buttonInstructionStart\" onClick={()=>this.redirectToQuiz()}>\n          <span className=\"bold\">START</span>\n          </Button>\n        </center>\n      </div>\n      </center> \n      </div>);\n    } \n\n     else if ((this.state.block_info.surveytag !== survey_list[0]) && (this.state.newblock_frame)) \n    { \n        console.log(this.state.block_number)\n        return(<div>{this._handleTimeOut()}</div>);\n      }\n\n    else if (this.props.location.state.participant_info.block_number === this.props.location.state.participant_info.TotalBlock && this.state.finished===true) \n    {\n      text = <div className='SurveyIntroText'> <p><span className=\"bold\">You finished the survey!</span> </p>\n      <p>Thank you for your participation!</p> \n      <Button variant=\"secondary\" color=\"danger\" size=\"sm\" className=\"buttonInstructionFinal\" type=\"submit\" onClick={() => this.redirectToEnd()}>Click here </Button></div>\n        return (\n          <div>\n          <center> \n          <div className=\"restarttraining\">\n              {text}  <div className=\"translate\"/>\n            </div>\n          </center>\n          </div>);        \n    }\n\n    else\n    {\n          text = '... CONTINUE ...'\n        return (\n      <div>\n      <center>\n      <div className=\"SurveyIntroText\">\n        {text}           \n      </div>\n      <center>\n            <Button className=\"buttonInstructionStart\" onClick={()=>this.redirectToQuiz()}>\n            &#8594;\n            </Button>\n            </center>\n    </center>\n    </div>);\n    }    \n  }\n\n}\n\nexport default withRouter(Survey);"]},"metadata":{},"sourceType":"module"}